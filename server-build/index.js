(()=>{"use strict";var e={156:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(o(252)),r=n(o(305));n(o(818)).default.config();const i=(0,s.default)(),a=process.env.PORT||3e3;i.use(s.default.json({limit:"10mb",strict:!1})),i.use(r.default),i.use(s.default.static("./build")),i.listen(a,(()=>{console.log(`âš¡ï¸[server]: Server started on ${a}`)}))},845:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.health=void 0,t.health=(e,t)=>{t.status(200).json({message:"wm-api is up ðŸŸ¢"})}},39:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(s,r){function i(e){try{u(n.next(e))}catch(e){r(e)}}function a(e){try{u(n.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?s(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,a)}u((n=n.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.monday=void 0;const r=o(713),i=s(o(163));s(o(818)).default.config(),t.monday=(e,t)=>n(void 0,void 0,void 0,(function*(){new r.ApiClient(String(process.env.MONDAY_KEY));const e=(0,i.default)();e.setApiVersion("2023-10"),e.setToken(String(process.env.MONDAY_KEY));const o=yield e.api("query { users { name } }");t.status(200).json({message:o})}))},80:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(s,r){function i(e){try{u(n.next(e))}catch(e){r(e)}}function a(e){try{u(n.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?s(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,a)}u((n=n.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.salesforce=void 0;const r=s(o(130));s(o(818)).default.config(),t.salesforce=(e,t)=>n(void 0,void 0,void 0,(function*(){const e=`${process.env.TOKEN}`,o=`${process.env.USER}`,n=new r.default.Connection({loginUrl:"https://login.salesforce.com"}),s=yield n.login(o,e,(function(e,t){if(e)return console.error(e);console.log("Logged in as: "+t.id,JSON.stringify(t));try{return n.query("SELECT Id, Name, Email FROM User")}catch(e){return{ERROR:e}}}));t.status(200).json({message:s})}))},495:function(e,t,o){var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var s=Object.getOwnPropertyDescriptor(t,o);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,s)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&n(t,e,o);return s(t,e),t},i=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(s,r){function i(e){try{u(n.next(e))}catch(e){r(e)}}function a(e){try{u(n.throw(e))}catch(e){r(e)}}function u(e){var t;e.done?s(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,a)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.smartsheet=void 0;const u=r(o(384)),c=a(o(71));a(o(818)).default.config(),t.smartsheet=(e,t)=>i(void 0,void 0,void 0,(function*(){const e=new u.createClient({accessToken:process.env.SMARTSHEET_KEY}),o=yield function(t){return i(this,void 0,void 0,(function*(){const t={json:"",csv:""};return yield e.sheets.getSheetAsCSV({id:0xa430e423f4f84,format:"csv",downloadPath:"./sheet.csv"}).then((e=>{t.csv=e})).catch((e=>{console.error("Error downloading sheet:",e)})),(null==t?void 0:t.csv)&&(yield(0,c.default)({noheader:!1,output:"json"}).fromString(o.csv).then((e=>{t.json=e}))),t}))}();if(o)try{o.json=yield(0,c.default)({noheader:!1,output:"json"}).fromString(o.csv)}catch(e){console.log("Error:",e)}t.status(200).json({message:o})}))},133:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.smartsheetWebhook=void 0,t.smartsheetWebhook=(e,t)=>{const o=e.body;console.log("Received webhook event: ",o),t.status(200).json({message:"Received webhook event",event:o})}},305:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=o(845),r=o(133),i=o(39),a=o(495),u=o(80),c=o(94),l=n(o(252)).default.Router();l.get("/api/ss-webhook",r.smartsheetWebhook),l.get("/api/smartsheet",a.smartsheet),l.get("/api/salesforce",u.salesforce),l.get("/api/monday",i.monday),l.get("/health",s.health),l.get("/api/version",((e,t)=>{(0,c.sendSuccessResponse)({res:t,data:{release:process.env.RELEASE_NUMBER||.1,build:process.env.BUILD_NUMBER||.1,date:process.env.BUILD_DATE||(new Date).toISOString().replace("T"," ").slice(0,19)},message:null,statusCode:200})})),t.default=l},94:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sendSuccessResponse=t.delay=t.validateEmail=void 0,t.validateEmail=e=>String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),t.delay=e=>new Promise((t=>setTimeout(t,e))),t.sendSuccessResponse=({res:e,data:t={},message:o,statusCode:n,count:s,clearCookie:r=!1})=>{s&&(t.count=s);let i={data:t};return r&&e.clearCookie("accessToken"),e.status(n).json(i)}},713:e=>{e.exports=require("@mondaydotcomorg/api")},71:e=>{e.exports=require("csvtojson")},818:e=>{e.exports=require("dotenv")},252:e=>{e.exports=require("express")},130:e=>{e.exports=require("jsforce")},163:e=>{e.exports=require("monday-sdk-js")},384:e=>{e.exports=require("smartsheet")}},t={};!function o(n){var s=t[n];if(void 0!==s)return s.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,o),r.exports}(156)})();
//# sourceMappingURL=index.js.map